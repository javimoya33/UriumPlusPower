(()=>{"use strict";var e={n:t=>{var a=t&&t.__esModule?()=>t.default:()=>t;return e.d(a,{a}),a},d:(t,a)=>{for(var o in a)e.o(a,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:a[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.element,a=window.wp.plugins,o=window.wp.editPost,r=window.wp.components,n=window.wp.apiFetch;var l=e.n(n);const __=wp.i18n.__;(0,a.registerPlugin)("trx-addons-ai-helper-setting-panel",{render:()=>{const[e,a]=(0,t.useState)(!1),n=TRX_ADDONS_STORAGE.ai_helper_list_commands,[s,c]=(0,t.useState)("write_blog"),i=TRX_ADDONS_STORAGE.ai_helper_list_text_tones,[p,_]=(0,t.useState)("normal"),d=[];Object.keys(i).forEach((function(e){d.push({label:i[e],value:e})}));const m=TRX_ADDONS_STORAGE.ai_helper_list_text_languages,[h,u]=(0,t.useState)("english"),w=[];Object.keys(m).forEach((function(e){w.push({label:m[e],value:e})}));const g=TRX_ADDONS_STORAGE.ai_helper_list_bases,[b,S]=(0,t.useState)("prompt"),x=[];Object.keys(g).forEach((function(e){"title"==e&&s.indexOf("write_")<0&&"process_translate"!=s||"excerpt"==e&&"process_translate"!=s||["selected","content"].indexOf(e)>=0&&0===s.indexOf("write_")||x.push({label:g[e],value:e})}));const[O,A]=(0,t.useState)("prompt"==b?n[s].prompt:""),[E,R]=(0,t.useState)("");return(0,t.createElement)(o.PluginDocumentSettingPanel,{name:"trx-addons-ai-helper-panel",title:__("TRX Addons AI Helper"),className:"trx-addons-ai-helper-panel"},(0,t.createElement)(r.PanelRow,null,(0,t.createElement)(r.SelectControl,{label:__("AI Command:"),value:s,onChange:e=>{c(e),0===e.indexOf("write_")&&-1==["prompt","title"].indexOf(b)?(S("prompt"),A(n[e].prompt)):A("prompt"==b?n[e].prompt:"")}},Object.keys(n).map((e=>"/-"==e.slice(0,2)?(0,t.createElement)("optgroup",{label:n[e].title,key:e}):(0,t.createElement)("option",{value:e,key:e},n[e].title))))),"process_tone"==s&&(0,t.createElement)(r.PanelRow,null,(0,t.createElement)(r.SelectControl,{label:__("Text tone:"),value:p,options:d,onChange:e=>_(e)})),"process_translate"==s&&(0,t.createElement)(r.PanelRow,null,(0,t.createElement)(r.SelectControl,{label:__("Language:"),value:h,options:w,onChange:e=>u(e)})),(0,t.createElement)(r.PanelRow,null,(0,t.createElement)(r.SelectControl,{label:__("Based on:"),value:b,options:x,onChange:e=>{S(e),A("prompt"==e?n[s].prompt:""),"prompt"==e&&R("")}})),!1,"prompt"==b&&(0,t.createElement)(r.PanelRow,null,(0,t.createElement)(r.TextareaControl,{label:__("Prompt for AI:"),help:__("Write a prompt with a brief description of what you want to get in response"),value:O,onChange:e=>A(e)})),"prompt"!=b&&(0,t.createElement)(r.PanelRow,null,(0,t.createElement)(r.TextareaControl,{label:__("Additional Hint for AI:"),help:__("Write a hint with additional requirements/instructions for the AI ​​response"),value:E,onChange:e=>R(e)})),(0,t.createElement)(r.PanelRow,null,(0,t.createElement)(r.Button,{variant:"primary",disabled:e,isBusy:e,className:"trx_addons_ai_helper_button",onClick:()=>{e||(a(!0),async function(){const e=await l()({path:"/ai-helper/v1/get-response",method:"POST",data:{content:"content"==b?wp.data.select("core/editor").getEditedPostAttribute("content"):"title"==b?wp.data.select("core/editor").getEditedPostAttribute("title"):"excerpt"==b?wp.data.select("core/editor").getEditedPostAttribute("excerpt"):"selected"==b?(t="",window.getSelection?t=window.getSelection().toString():document.selection&&"Control"!=document.selection.type&&(t=document.selection.createRange().text),t||wp.data.select("core/block-editor").getSelectedBlock().attributes.content):"",command:s,base_on:b,prompt:O,hint:E,text_tone:p,text_language:h}});var t;if(a(!1),e&&e.hasOwnProperty("data")&&e.hasOwnProperty("error"))if(e.data){var o=e.data,r="",c=n[s].variations;if(c)for(var i=0;i<o.length;i++)r+='<label class="trx_addons_ai_helper_response__variant"><input name="trx_addons_ai_helper_response__variant" type="radio" value="'+o[i]+'">'+o[i]+"</label>";else r='<textarea class="trx_addons_ai_helper_response__content" name="trx_addons_ai_helper_response__content" rows="15">'+trx_addons_esc_html(o[0])+"</textarea>";var _=[TRX_ADDONS_STORAGE.msg_ai_helper_bt_caption_replace,TRX_ADDONS_STORAGE.msg_ai_helper_bt_caption_append,TRX_ADDONS_STORAGE.msg_caption_cancel];["process_title","process_excerpt"].indexOf(s)>=0?_=[TRX_ADDONS_STORAGE.msg_caption_apply,TRX_ADDONS_STORAGE.msg_caption_cancel]:"process_heading"==s&&(_=[TRX_ADDONS_STORAGE.msg_ai_helper_bt_caption_prepend,TRX_ADDONS_STORAGE.msg_caption_cancel]),trx_addons_msgbox_dialog('<form name="trx_addons_ai_helper_response" class="trx_addons_ai_helper_response">'+r+"</form>",TRX_ADDONS_STORAGE["msg_ai_helper_response"+(c?"_variations":"")],null,(function(e,t){if(e<_.length){var a=c?t.find('input[name="trx_addons_ai_helper_response__variant"]:checked').val():t.find("textarea").text();if("process_title"==s||"process_translate"==s&&"title"==b)wp.data.dispatch("core/editor").editPost({title:trx_addons_clear_tags(a)});else if("process_excerpt"==s||"process_translate"==s&&"excerpt"==b)wp.data.dispatch("core/editor").editPost({excerpt:trx_addons_clear_tags(a)});else{"process_heading"==s&&(a="<h3>"+a+"</h3>"),a=wp.blocks.serialize(wp.blocks.rawHandler({HTML:a}));var o=wp.blocks.parse(a);if("selected"==b){var r=wp.data.select("core/block-editor").getSelectedBlockCount()>1?wp.data.select("core/block-editor").getMultiSelectedBlockClientIds():[wp.data.select("core/block-editor").getSelectedBlockClientId()];1==e?"process_heading"==s?wp.data.dispatch("core/block-editor").insertBlocks(o,wp.data.select("core/block-editor").getBlockIndex(r[0],wp.data.select("core/block-editor").getSelectedBlockClientId())):wp.data.dispatch("core/block-editor").replaceBlocks(r,o):wp.data.dispatch("core/block-editor").insertBlocks(o,wp.data.select("core/block-editor").getBlockIndex(r[r.length-1],wp.data.select("core/block-editor").getSelectedBlockClientId())+1)}else 1==e?"process_heading"==s?wp.data.dispatch("core/editor").insertBlocks(o,0):wp.data.dispatch("core/editor").resetBlocks(o):wp.data.dispatch("core/editor").insertBlocks(o)}}}),_,"wpforms")}else trx_addons_msgbox_warning(e.error?e.error:TRX_ADDONS_STORAGE.msg_ai_helper_error,TRX_ADDONS_STORAGE.msg_ai_helper_error);else trx_addons_msgbox_warning(TRX_ADDONS_STORAGE.msg_ai_helper_error)}())}},(0,t.createElement)(r.Icon,{className:"trx_addons_ai_helper_button_icon",icon:e?"update":"welcome-write-blog"}),(0,t.createElement)("span",{className:"trx_addons_ai_helper_button_text"},__("Generate")))))},icon:"rest-api"})})();